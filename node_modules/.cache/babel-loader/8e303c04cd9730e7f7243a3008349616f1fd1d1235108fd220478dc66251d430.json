{"ast":null,"code":"import React,{createContext,useState,useCallback,useEffect}from'react';import config from'../config/environment';import{jsx as _jsx}from\"react/jsx-runtime\";export const AuthContext=/*#__PURE__*/createContext();export function AuthProvider(_ref){let{children}=_ref;const[user,setUser]=useState(null);const[isAuthenticated,setIsAuthenticated]=useState(false);const[loading,setLoading]=useState(false);const[token,setToken]=useState(null);// Restore token and auth state on mount\nuseEffect(()=>{if(config.useJWT){const savedToken=localStorage.getItem(config.tokenStorageKey);if(savedToken){setToken(savedToken);setIsAuthenticated(true);setUser({username:'Authenticated',isAdmin:true});}}else if(!config.requireAuth){// Local dev mode - auto-authenticate\nsetUser({username:'admin',name:'Admin',isAdmin:true});setIsAuthenticated(true);}},[]);const login=useCallback(async(username,password)=>{// Local environment - skip actual auth, just set user\nif(!config.requireAuth&&config.authType==='basic'){setUser({username,name:(username===null||username===void 0?void 0:username.split('@')[0])||'admin',isAdmin:true});setIsAuthenticated(true);return{success:true,message:'Local mode - Authentication skipped'};}setLoading(true);try{const response=await fetch(\"\".concat(config.backendUrl).concat(config.loginEndpoint),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username,password})});if(response.ok){const data=await response.json();if(config.useJWT&&data.token){// Store JWT token\nlocalStorage.setItem(config.tokenStorageKey,data.token);if(data.expiresIn){localStorage.setItem(config.tokenExpiryKey,Date.now()+data.expiresIn);}setToken(data.token);}setUser({username:data.username||username,name:data.name||username,isAdmin:true});setIsAuthenticated(true);return{success:true,message:'Login successful'};}else{const errorData=await response.json().catch(()=>({}));return{success:false,message:errorData.message||'Invalid credentials'};}}catch(error){console.error('Login error:',error);return{success:false,message:error.message};}finally{setLoading(false);}},[]);const logout=useCallback(()=>{localStorage.removeItem(config.tokenStorageKey);localStorage.removeItem(config.tokenExpiryKey);setToken(null);setUser(null);setIsAuthenticated(false);},[]);const getAuthHeader=useCallback(()=>{if(config.useJWT&&token){return{'Authorization':\"Bearer \".concat(token)};}else if(config.authType==='basic'){// For local dev - can be used if needed\nconst credentials=btoa(\"\".concat(config.defaultUsername,\":\").concat(config.defaultPassword));return{'Authorization':\"Basic \".concat(credentials)};}return{};},[token]);const isTokenValid=useCallback(()=>{if(!config.useJWT)return true;const expiry=localStorage.getItem(config.tokenExpiryKey);if(!expiry)return!!token;return Date.now()<parseInt(expiry);},[token]);const value={user,isAuthenticated,loading,token,login,logout,getAuthHeader,isTokenValid,requireAuth:config.requireAuth,useJWT:config.useJWT,authType:config.authType,environment:config.env,backendUrl:config.backendUrl,description:config.description};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:value,children:children});}export function useAuth(){const context=React.useContext(AuthContext);if(!context){throw new Error('useAuth must be used within AuthProvider');}return context;}","map":{"version":3,"names":["React","createContext","useState","useCallback","useEffect","config","jsx","_jsx","AuthContext","AuthProvider","_ref","children","user","setUser","isAuthenticated","setIsAuthenticated","loading","setLoading","token","setToken","useJWT","savedToken","localStorage","getItem","tokenStorageKey","username","isAdmin","requireAuth","name","login","password","authType","split","success","message","response","fetch","concat","backendUrl","loginEndpoint","method","headers","body","JSON","stringify","ok","data","json","setItem","expiresIn","tokenExpiryKey","Date","now","errorData","catch","error","console","logout","removeItem","getAuthHeader","credentials","btoa","defaultUsername","defaultPassword","isTokenValid","expiry","parseInt","value","environment","env","description","Provider","useAuth","context","useContext","Error"],"sources":["C:/Users/Abhishek Kandukuri/Downloads/temple_react_full/src/context/AuthContext.jsx"],"sourcesContent":["import React, { createContext, useState, useCallback, useEffect } from 'react';\r\nimport config from '../config/environment';\r\n\r\nexport const AuthContext = createContext();\r\n\r\nexport function AuthProvider({ children }) {\r\n  const [user, setUser] = useState(null);\r\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\r\n  const [loading, setLoading] = useState(false);\r\n  const [token, setToken] = useState(null);\r\n\r\n  // Restore token and auth state on mount\r\n  useEffect(() => {\r\n    if (config.useJWT) {\r\n      const savedToken = localStorage.getItem(config.tokenStorageKey);\r\n      if (savedToken) {\r\n        setToken(savedToken);\r\n        setIsAuthenticated(true);\r\n        setUser({ username: 'Authenticated', isAdmin: true });\r\n      }\r\n    } else if (!config.requireAuth) {\r\n      // Local dev mode - auto-authenticate\r\n      setUser({ username: 'admin', name: 'Admin', isAdmin: true });\r\n      setIsAuthenticated(true);\r\n    }\r\n  }, []);\r\n\r\n  const login = useCallback(async (username, password) => {\r\n    // Local environment - skip actual auth, just set user\r\n    if (!config.requireAuth && config.authType === 'basic') {\r\n      setUser({ username, name: username?.split('@')[0] || 'admin', isAdmin: true });\r\n      setIsAuthenticated(true);\r\n      return { success: true, message: 'Local mode - Authentication skipped' };\r\n    }\r\n\r\n    setLoading(true);\r\n    try {\r\n      const response = await fetch(`${config.backendUrl}${config.loginEndpoint}`, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ username, password })\r\n      });\r\n\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        \r\n        if (config.useJWT && data.token) {\r\n          // Store JWT token\r\n          localStorage.setItem(config.tokenStorageKey, data.token);\r\n          if (data.expiresIn) {\r\n            localStorage.setItem(config.tokenExpiryKey, Date.now() + data.expiresIn);\r\n          }\r\n          setToken(data.token);\r\n        }\r\n        \r\n        setUser({ \r\n          username: data.username || username, \r\n          name: data.name || username, \r\n          isAdmin: true \r\n        });\r\n        setIsAuthenticated(true);\r\n        return { success: true, message: 'Login successful' };\r\n      } else {\r\n        const errorData = await response.json().catch(() => ({}));\r\n        return { \r\n          success: false, \r\n          message: errorData.message || 'Invalid credentials' \r\n        };\r\n      }\r\n    } catch (error) {\r\n      console.error('Login error:', error);\r\n      return { success: false, message: error.message };\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  const logout = useCallback(() => {\r\n    localStorage.removeItem(config.tokenStorageKey);\r\n    localStorage.removeItem(config.tokenExpiryKey);\r\n    setToken(null);\r\n    setUser(null);\r\n    setIsAuthenticated(false);\r\n  }, []);\r\n\r\n  const getAuthHeader = useCallback(() => {\r\n    if (config.useJWT && token) {\r\n      return { 'Authorization': `Bearer ${token}` };\r\n    } else if (config.authType === 'basic') {\r\n      // For local dev - can be used if needed\r\n      const credentials = btoa(`${config.defaultUsername}:${config.defaultPassword}`);\r\n      return { 'Authorization': `Basic ${credentials}` };\r\n    }\r\n    return {};\r\n  }, [token]);\r\n\r\n  const isTokenValid = useCallback(() => {\r\n    if (!config.useJWT) return true;\r\n    const expiry = localStorage.getItem(config.tokenExpiryKey);\r\n    if (!expiry) return !!token;\r\n    return Date.now() < parseInt(expiry);\r\n  }, [token]);\r\n\r\n  const value = {\r\n    user,\r\n    isAuthenticated,\r\n    loading,\r\n    token,\r\n    login,\r\n    logout,\r\n    getAuthHeader,\r\n    isTokenValid,\r\n    requireAuth: config.requireAuth,\r\n    useJWT: config.useJWT,\r\n    authType: config.authType,\r\n    environment: config.env,\r\n    backendUrl: config.backendUrl,\r\n    description: config.description\r\n  };\r\n\r\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\r\n}\r\n\r\nexport function useAuth() {\r\n  const context = React.useContext(AuthContext);\r\n  if (!context) {\r\n    throw new Error('useAuth must be used within AuthProvider');\r\n  }\r\n  return context;\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}